(window.webpackJsonp=window.webpackJsonp||[]).push([[246],{882:function(t,s,a){"use strict";a.r(s);var e=a(18),v=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、浏览器渲染机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、浏览器渲染机制"}},[t._v("#")]),t._v(" 一、浏览器渲染机制")]),t._v(" "),a("ul",[a("li",[t._v("采用流式布局模型（"),a("code",[t._v("Flow Based Layout")]),t._v("）")]),t._v(" "),a("li",[t._v("浏览器会把"),a("code",[t._v("HTML")]),t._v("解析成"),a("code",[t._v("DOM")]),t._v("，把"),a("code",[t._v("CSS")]),t._v("解析成"),a("code",[t._v("CSSOM")]),t._v("，"),a("code",[t._v("DOM")]),t._v("和"),a("code",[t._v("CSSOM")]),t._v("合并就产生了渲染树（"),a("code",[t._v("Render Tree")]),t._v("）。")]),t._v(" "),a("li",[t._v("有了"),a("code",[t._v("RenderTree")]),t._v("，我们就知道了所有节点的样式，然后计算他们在页面上的大小和位置，最后把节点绘制到页面上。")]),t._v(" "),a("li",[t._v("由于浏览器使用流式布局，对"),a("code",[t._v("Render Tree")]),t._v("的计算通常只需要遍历一次就可以完成，"),a("strong",[t._v("但"),a("code",[t._v("table")]),t._v("及其内部元素除外，他们可能需要多次计算，通常要花3倍于同等元素的时间，这也是为什么要避免使用"),a("code",[t._v("table")]),t._v("布局的原因之一")]),t._v("。")])]),t._v(" "),a("h2",{attrs:{id:"二、重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、重绘"}},[t._v("#")]),t._v(" 二、重绘")]),t._v(" "),a("ul",[a("li",[t._v("重绘（repaint）")]),t._v(" "),a("li",[t._v("节点的几何属性发生改变或者由于样式发生改变而不会影响布局的。")]),t._v(" "),a("li",[t._v("例如"),a("code",[t._v("outline")]),t._v(", "),a("code",[t._v("visibility")]),t._v(", "),a("code",[t._v("color")]),t._v("、"),a("code",[t._v("background-color")]),t._v("等。")]),t._v(" "),a("li",[t._v("重绘的代价，因为浏览器必须验证DOM树上其他节点元素的可见性。")])]),t._v(" "),a("h2",{attrs:{id:"三、回流-重排"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、回流-重排"}},[t._v("#")]),t._v(" 三、回流(重排)")]),t._v(" "),a("ul",[a("li",[t._v("回流（reflow）")]),t._v(" "),a("li",[t._v("布局或几何属性需要改变。")]),t._v(" "),a("li",[t._v("回流是影响浏览器性能的关键因素，因为其变化涉及到部分页面（或是整个页面）的布局更新。一个元素的回流可能会导致了其所有子元素以及DOM中紧随其后的节点、祖先节点元素的随后的回流。")]),t._v(" "),a("li",[a("strong",[t._v("大部分的回流将导致页面的重新渲染。")])]),t._v(" "),a("li",[a("strong",[t._v("回流必定会发生重绘，重绘不一定会引发回流。")])])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/guoqiankunmiss/article/details/108454062",target:"_blank",rel:"noopener noreferrer"}},[t._v("css属性值改变触发重排重绘的具体属性以及改变情况"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"四、浏览器优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、浏览器优化"}},[t._v("#")]),t._v(" 四、浏览器优化")]),t._v(" "),a("p",[t._v("现代浏览器大多都是通过队列机制来批量更新布局，浏览器会把修改操作放在队列中，至少一个浏览器刷新（即16.6ms）才会清空队列，但当你"),a("strong",[t._v("获取布局信息的时候，队列中可能有会影响这些属性或方法返回值的操作，即使没有，浏览器也会强制清空队列，触发回流与重绘来确保返回正确的值")]),t._v("。")]),t._v(" "),a("p",[t._v("主要包括以下属性或方法：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("offsetTop")]),t._v("、"),a("code",[t._v("offsetLeft")]),t._v("、"),a("code",[t._v("offsetWidth")]),t._v("、"),a("code",[t._v("offsetHeight")])]),t._v(" "),a("li",[a("code",[t._v("scrollTop")]),t._v("、"),a("code",[t._v("scrollLeft")]),t._v("、"),a("code",[t._v("scrollWidth")]),t._v("、"),a("code",[t._v("scrollHeight")])]),t._v(" "),a("li",[a("code",[t._v("clientTop")]),t._v("、"),a("code",[t._v("clientLeft")]),t._v("、"),a("code",[t._v("clientWidth")]),t._v("、"),a("code",[t._v("clientHeight")])]),t._v(" "),a("li",[a("code",[t._v("width")]),t._v("、"),a("code",[t._v("height")])]),t._v(" "),a("li",[a("code",[t._v("getComputedStyle()")])]),t._v(" "),a("li",[a("code",[t._v("getBoundingClientRect()")])])]),t._v(" "),a("p",[t._v("所以，我们应该避免频繁的使用上述的属性，他们都会强制渲染刷新队列。")]),t._v(" "),a("h2",{attrs:{id:"五、减少重绘与回流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、减少重绘与回流"}},[t._v("#")]),t._v(" 五、减少重绘与回流")]),t._v(" "),a("h3",{attrs:{id:"_5-1-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-css"}},[t._v("#")]),t._v(" 5.1.css")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("使用 "),a("code",[t._v("transform")]),t._v(" 替代 "),a("code",[t._v("top")])]),t._v("、"),a("code",[t._v("left")])]),t._v(" "),a("li",[a("strong",[t._v("使用 "),a("code",[t._v("visibility")]),t._v(" 替换 "),a("code",[t._v("display: none")])]),t._v(" ，因为前者只会引起重绘，后者改变了布局会引发回流。")]),t._v(" "),a("li",[a("strong",[t._v("避免使用"),a("code",[t._v("table")]),t._v("布局")]),t._v("，可能很小的一个小改动会造成整个 "),a("code",[t._v("table")]),t._v(" 的重新布局。")]),t._v(" "),a("li",[a("strong",[t._v("尽可能在"),a("code",[t._v("DOM")]),t._v("树的最末端改变"),a("code",[t._v("class")])]),t._v("，回流是不可避免的，但可以减少其影响。尽可能在DOM树的最末端改变class，可以限制了回流的范围，使其影响尽可能少的节点。")]),t._v(" "),a("li",[a("strong",[t._v("避免设置多层内联样式")]),t._v("，CSS 选择符"),a("strong",[t._v("从右往左")]),t._v("匹配查找，避免节点层级过多。")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("将动画效果应用到"),a("code",[t._v("position")]),t._v("属性为"),a("code",[t._v("absolute")]),t._v("或"),a("code",[t._v("fixed")]),t._v("的元素上")]),t._v("，避免影响其他元素的布局，这样只是一个重绘，而不是回流，同时，控制动画速度可以选择 "),a("a",{attrs:{href:"https://www.cnblogs.com/jiajia-hjj/p/15405720.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("requestAnimationFrame"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("li",[a("strong",[t._v("避免使用"),a("code",[t._v("CSS")]),t._v("表达式")]),t._v("，可能会引发回流。")]),t._v(" "),a("li",[a("strong",[t._v("将频繁重绘或者回流的节点设置为图层")]),t._v("，图层能够阻止该节点的渲染行为影响别的节点，浏览器什么时候会创建一个独立的复合图层呢？\n"),a("ul",[a("li",[a("code",[t._v("video")]),t._v("、"),a("code",[t._v("iframe")]),t._v("、"),a("code",[t._v("canvas")]),t._v("等标签")]),t._v(" "),a("li",[t._v("will-change")]),t._v(" "),a("li",[t._v("3D 或者 CSS transform")]),t._v(" "),a("li",[t._v("元素覆盖时，比如使用了 "),a("code",[t._v("z-index")]),t._v(" 属性...浏览器会自动将该节点变为图层。")])])]),t._v(" "),a("li",[a("strong",[t._v("CSS3 硬件加速（GPU加速）")]),t._v("，使用css3硬件加速，可以让"),a("code",[t._v("transform")]),t._v("、"),a("code",[t._v("opacity")]),t._v("、"),a("code",[t._v("filters")]),t._v("这些动画不会引起回流重绘 。但是对于动画的其它属性，比如"),a("code",[t._v("background-color")]),t._v("这些，还是会引起回流重绘的，不过它还是可以提升这些动画的性能。(见6.2)")])]),t._v(" "),a("h3",{attrs:{id:"_5-2-javascript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-javascript"}},[t._v("#")]),t._v(" 5.2.JavaScript")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("避免频繁操作样式")]),t._v("，最好一次性重写"),a("code",[t._v("style")]),t._v("属性，或者将样式列表定义为"),a("code",[t._v("class")]),t._v("并一次性更改"),a("code",[t._v("class")]),t._v("属性。")]),t._v(" "),a("li",[a("strong",[t._v("避免频繁操作"),a("code",[t._v("DOM")])]),t._v("，创建一个"),a("code",[t._v("documentFragment")]),t._v("，在它上面应用所有"),a("code",[t._v("DOM操作")]),t._v("，最后再把它添加到文档中。")]),t._v(" "),a("li",[a("strong",[t._v("避免频繁读取会引发回流/重绘的属性")]),t._v("，如果确实需要多次使用，就用一个变量缓存起来。")]),t._v(" "),a("li",[a("strong",[t._v("对具有复杂动画的元素使用绝对定位")]),t._v("，使它脱离文档流，否则会引起父元素及后续元素频繁回流。")])]),t._v(" "),a("h2",{attrs:{id:"六、其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、其他"}},[t._v("#")]),t._v(" 六、其他")]),t._v(" "),a("h3",{attrs:{id:"_6-1-css3-硬件加速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-css3-硬件加速"}},[t._v("#")]),t._v(" 6.1.CSS3 硬件加速")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("硬件加速是指通过创建独立的复合图层，让GPU来渲染这个图层，从而提高性能")])]),t._v(" "),a("li",[a("p",[t._v("可以触发硬件加速："),a("strong",[t._v("transform")]),t._v("、"),a("strong",[t._v("opacity")]),t._v("、"),a("strong",[t._v("filter")]),t._v("、"),a("strong",[t._v("will-change")])])])]),t._v(" "),a("p",[a("strong",[t._v("1、3D变形来开启GPU加速")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("2D动画在开始和结束的会重绘。可使用translate3d() rotate3d() scale3d()")])]),t._v(" "),a("li",[a("p",[t._v("不需要对元素应用3D变换的效果，可以使用：")])])]),t._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("translateZ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[t._v("Chrome和Sfari中，当我们使用CSS transforms或者animations时可能会有"),a("strong",[t._v("页面闪烁")]),t._v("的效果，下面的代码可以修复此情况：")])]),t._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".cube")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-moz-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-ms-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-o-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-moz-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-ms-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-o-backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("backface-visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("bility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[a("strong",[t._v("2、will-change")])]),t._v(" "),a("ul",[a("li",[t._v("允许开发者告知浏览器哪一个属性即将发生变化，从而为浏览器对该属性进行优化提供了时间。兼容性不好。")])]),t._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".example")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("will-change")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" transform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("3、注意：")])]),t._v(" "),a("ul",[a("li",[t._v("过分使用GPU可能会导致严重的性能问题")]),t._v(" "),a("li",[t._v("因为它增加了内存的使用，而且它会减少移动端设备电池寿命，所以只对我们需要实现动画效果的元素应用")])])])}),[],!1,null,null,null);s.default=v.exports}}]);