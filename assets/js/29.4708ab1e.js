(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{623:function(a,s,t){a.exports=t.p+"assets/img/e1a45d8f7cb4d98e6320eb8d65f3308d.728ee2e0.png"},813:function(a,s,t){"use strict";t.r(s);var n=t(18),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,n=a._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h2",{attrs:{id:"一、iframe"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、iframe"}},[a._v("#")]),a._v(" 一、iframe")]),a._v(" "),n("ul",[n("li",[a._v("嵌入第三方 iframe 会有很多不可控的问题，他们可以在iframe中运行JavaScirpt脚本、Flash插件、弹出对话框等等，这可能会破坏前端用户体验。")]),a._v(" "),n("li",[a._v("如果iframe中的域名因为过期而被恶意攻击者抢注，或者第三方被黑客攻破，iframe中的内容被替换掉了，从而利用用户浏览器中的安全漏洞下载安装木马、恶意勒索软件等等")]),a._v(" "),n("li",[a._v("（点击劫持攻击者将目标网站通过 iframe 嵌套的方式嵌入自己的网页中，并将iframe 设置为透明，诱导用户点击。）")]),a._v(" "),n("li",[a._v("禁止自己的 iframe 中，链接外部网站的JS")])]),a._v(" "),n("h2",{attrs:{id:"二、iframe基本用法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、iframe基本用法"}},[a._v("#")]),a._v(" 二、iframe基本用法")]),a._v(" "),n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("iframe")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("demo_iframe_sandbox.htm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("iframe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("p",[n("strong",[a._v("iframe常用属性:")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("1.frameborder:是否显示边框，1(yes),0(no)\n2.height:框架作为一个普通元素的高度，建议在使用css设置。\n3.width:框架作为一个普通元素的宽度，建议使用css设置。\n4.name:框架的名称，window.frames[name]时专用的属性。\n5.scrolling:框架的是否滚动。yes,no,auto。\n6.src：内框架的地址，可以使页面地址，也可以是图片的地址。\n7.srcdoc , 用来替代原来HTML body里面的内容。但是IE不支持, 不过也没什么卵用‘\n8.sandbox: 对iframe进行一些列限制，IE10+支持\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br")])]),n("ul",[n("li",[a._v("我们通常使用iframe最基本的特性，就是能自由操作iframe和父框架的内容(DOM)")]),a._v(" "),n("li",[a._v("但前提条件是同域，如果跨域顶多只能实现页面跳转"),n("code",[a._v("window.location.href")])])]),a._v(" "),n("h2",{attrs:{id:"三、防止点击劫持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、防止点击劫持"}},[a._v("#")]),a._v(" 三、防止点击劫持")]),a._v(" "),n("ul",[n("li",[a._v("我们在通过iframe使用别人提供的内容时，我们自己的页面也可能正在被不法分子放到他们精心构造的iframe或者frame当中，进行点击劫持攻击。(钓鱼)")]),a._v(" "),n("li",[a._v("这是一种欺骗性比较强，同时也需要用户高度参与才能完成的一种攻击。")]),a._v(" "),n("li",[a._v("通常的攻击步骤是这样的：")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("+ 攻击者精心构造一个诱导用户点击的内容，比如Web页面小游戏\n+ 将我们的页面放入到iframe当中\n+ 利用z-index等CSS样式将这个iframe叠加到小游戏的垂直方向的正上方\n+ 把iframe设置为100%透明度\n+ 受害者访问到这个页面后，肉眼看到的是一个小游戏，如果受到诱导进行了点击的话，实际上点击到的却是iframe中的我们的页面\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("ul",[n("li",[a._v("点击劫持的危害在于，攻击利用了受害者的用户身份，在其不知情的情况下进行一些操作。")]),a._v(" "),n("li",[a._v("如果只是迫使用户关注某个微博账号的话，看上去仿佛还可以承受，但是如果是删除某个重要文件记录，或者窃取敏感信息，那么造成的危害可就难以承受了。")])]),a._v(" "),n("h2",{attrs:{id:"四、防预方案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、防预方案"}},[a._v("#")]),a._v(" 四、防预方案")]),a._v(" "),n("h3",{attrs:{id:"_1-防嵌套网页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-防嵌套网页"}},[a._v("#")]),a._v(" "),n("strong",[a._v("（1）防嵌套网页")])]),a._v(" "),n("ul",[n("li",[a._v("为了防止网站被钓鱼，可以使用window.top来防止你的网页被iframe.")])]),a._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("window "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!=")]),a._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" correctURL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1234")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])]),n("ul",[n("li",[a._v("这段代码的主要用途是限定你的网页不能嵌套在任意网页内。")]),a._v(" "),n("li",[a._v("如果你想引用同域的框架的话，可以判断域名。")])]),a._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("host "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!=")]),a._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("host"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n　　top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("href"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 检测当前网站是否被第三方iframe引用")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 若相等证明没有被第三方引用，若不等证明被第三方引用。当发现被引用时强制跳转百度。")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!=")]),a._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n　　top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'http://www.baidu.com'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br")])]),n("ul",[n("li",[a._v("当然，如果你网页不同域名的话，上述就会报错。")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('"window.location.href"、"location.href"是本页⾯跳转\n"parent.location.href"是上⼀层页⾯跳转\n"top.location.href"是最外层的页⾯跳转, 因为页面之中可能嵌入了 frame 等子页面，top表示最外面一层。\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])]),n("h3",{attrs:{id:"_2-x-frame-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-x-frame-options"}},[a._v("#")]),a._v(" "),n("strong",[a._v("（2）X-Frame-Options")])]),a._v(" "),n("ul",[n("li",[a._v("X-Frame-Options是一个响应头，主要是描述服务器的网页资源的iframe权限。目前的支持度是IE8+。")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("有3个选项:\n+ DENY：当前页面不能被嵌套iframe里，即便是在相同域名的页面中嵌套也不允许,也不允许网页中有嵌套iframe\n+ SAMEORIGIN：iframe页面的地址只能为同源域名下的页面\n+ ALLOW-FROM：可以在指定的origin url的iframe中加载123\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("简单实例:")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("X-Frame-Options: DENY\n拒绝任何iframe的嵌套请求\n\nX-Frame-Options: SAMEORIGIN\n只允许同源请求，例如网页为 foo.com/123.php，則 foo.com 底下的所有网页可以嵌入此网页，但是 foo.com 以外的网页不能嵌入\n\n\nX-Frame-Options: ALLOW-FROM http://s3131212.com\n只允许指定网页的iframe请求，不过兼容性较差Chrome不支持123456789\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br")])]),n("ul",[n("li",[n("code",[a._v("X-Frame-Options")]),a._v("其实就是将前端js对iframe的把控交给服务器来进行处理。")]),a._v(" "),n("li",[a._v("该属性是对页面的iframe进行一个主要限制，不过，涉及iframe的header可不止这一个，另外还有一个"),n("code",[a._v("Content Security Policy")]),a._v(", 他同样也可以对iframe进行限制，而且，他应该是以后网页安全防护的主流。")])]),a._v(" "),n("h3",{attrs:{id:"_3-csp之页面防护"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-csp之页面防护"}},[a._v("#")]),a._v(" "),n("strong",[a._v("（3）CSP之页面防护")])]),a._v(" "),n("ul",[n("li",[a._v("和"),n("code",[a._v("X-Frames-Options")]),a._v("一样，都需要在服务器端设置好相关的Header. CSP 的作用， 真的是太大了，他能够极大的防止你的页面被XSS攻击，而且可以制定js,css,img等相关资源的origin，防止被恶意注入。不过兼容性不好。")]),a._v(" "),n("li",[a._v("而且目前市面上，流行的是3种CSP头，以及各种浏览器的兼容性：\n"),n("img",{attrs:{src:t(623),alt:"这里写图片描述"}})]),a._v(" "),n("li",[a._v("使用主要是在后端服务器上配置，在前端，我们可以观察Response Header 里是否有这样的一个Header:")])]),a._v(" "),n("div",{staticClass:"language-cms line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("Content-Security-Policy: default-src 'self'\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("ul",[n("li",[a._v("这就表明，你的网页是启用CSP的。")])]),a._v(" "),n("h3",{attrs:{id:"_4-限制iframe的第三方网页-sandbox属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-限制iframe的第三方网页-sandbox属性"}},[a._v("#")]),a._v(" "),n("strong",[a._v("（4）限制iframe的第三方网页-sandbox属性")])]),a._v(" "),n("ul",[n("li",[a._v("当"),n("code",[a._v("iframe")]),a._v("别人的页面时，我们需要对其进行安全设限，虽然，跨域时"),n("code",[a._v("iframe")]),a._v("的安全性会大很多，但是，互联网是没有安全的地方。")]),a._v(" "),n("li",[a._v("通过h5提供的一个新属性"),n("code",[a._v("sandbox")]),a._v("可以对"),n("code",[a._v("iframe")]),a._v("的行为进行各种限制，充分实现“最小权限“原则。")]),a._v(" "),n("li",[a._v("使用"),n("code",[a._v("sandbox")]),a._v("的最简单的方式就是只在"),n("code",[a._v("iframe")]),a._v("元素中添加上这个关键词就好：")])]),a._v(" "),n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("iframe")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("sandbox")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("..."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" ... "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("iframe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("ul",[n("li",[n("p",[a._v("sandbox的实现了“Secure By Default”原则，也就是说，如果你只是添加上这个属性而保持属性值为空，那么浏览器将会对iframe实施史上最严厉的调控限制，基本上来讲就是除了允许显示静态资源以外，其他什么都做不了。")])]),a._v(" "),n("li",[n("p",[a._v("比如不准提交表单、不准弹窗、不准执行脚本等等，连Origin都会被强制重新分配一个唯一的值，换句话讲就是"),n("code",[a._v("iframe")]),a._v("中的页面访问它自己的服务器都会被算作跨域请求。")])])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('配置参数:\n+ allow-forms：允许iframe中提交form表单\n+ allow-popups：允许iframe中弹出新的窗口或者标签页（例如，window.open()，showModalDialog()，target=”_blank”等等）\n+ allow-scripts：允许iframe中执行JavaScript\n+ allow-same-origin：允许iframe中的网页开启同源策略\n+ ""：设置为什么所以允许全部禁止 \n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br")])]),n("blockquote",[n("p",[a._v("转自：")]),a._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/yanner_/article/details/81428965",target:"_blank",rel:"noopener noreferrer"}},[a._v("iframe安全问题"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);