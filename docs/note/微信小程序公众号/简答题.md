## 微信小程序原理

+ 微信小程序采用 JavaScript 、 WXML 、 WXSS 三种技术进行开发，本质就是一个**单页面应用**，所有的页面渲染和事件处理，都在一个页面内进行，但又可以通过微信客户端调用原生的各种接口
+ 微信的架构，是数据驱动的架构模式，它的UI 和数据是分离的，**所有的页面更新，都需要通过对数据的更改来实现**（数据流单项： Model ---> View）
+ 小程序分为两个部分 webview 和 appService 。其中 webview 主要用来展现 Ul , appService 有来处理业务逻辑、数据及接口调用。它们在**两个进程**中运行，通过系统层 JSBridge 实现通信，实现 UI 的渲染、事件的处理

## 小程序中数据怎么同步渲染

> 通过 setData 方法

 **setData 工作原理**

+ 小程序分为逻辑层和渲染层，而我们每次逻辑层改变了，要借由 Native 进行。
+ 小程序的渲染层和逻辑层由两个线程管理：渲染层的界面使用了 WebView 进行渲染；逻辑层采用 JsCore 线程运行 JS 脚本。
+ 一个小程序存在多个界面，所以渲染层存在多个 WebView 线程，这两个线程的通信会经由微信客户端 Native 做中转，逻辑层发送网络请求也经由 Native 转发

**性能优化**

+ 所以我们不要重复 setdata ，以及减少数据的传输量。
+ 我们的数据传输实际是一次 Javascript 脚本过程，当数据量过大时会增加脚本的编译执行时间，用 WebView JS 线程。
+ 去除不必要的事件绑定（ WXML 中的 bind 和 catch )，从而减少通信的数据量和次数。

## 微信小程序与vue区别

+ **生命周期不一样，小程序比较简单**
  + 小程序：onLoad-页面加载、onShow-页面显示、onReady-页面初次渲染完成、onHide-页面隐藏、onUnload-页面卸载
  + vue：beforecreate、created、beforemout、mouted、beforeupdate、updated、beforedestory、destroyed
  + vue的在跳转新页面时，钩子函数都会触发
  + 小程序跳转新页面时，不同的跳转方式，触发的钩子并不一样
+ **在页面加载请求数据时，数据请求时间不一样：**
  + 小程序：会在 onLoad或者 onShow中请求数据 
  + vue：一般会在 created或者 mounted中请求数据

+ **数据绑定不一样**
  + 小程序：`url="{{data}}"`
  + vue动态绑定一个变量的值为元素的某个属性的时候，`:url="data"`
+ **控制元素的显示隐藏不一样**
  + 小程序：wx:if、hidden
  + vue：v-if、v-show
+ **事件处理不同**
  + 小程序全用：bindtap（bind+event）或者catchtap（catch+event）。 catchtap阻止事件冒泡。 
  + vue：v-on:event  或者 @event

+ **双向数据绑定不同**

  + 小程序：获取表单元素改变的值—>赋值给data中声明的值。（没有v-model）

  + vue：v-model="data"

+ **绑定事件传参不一样** 
  + vue：绑定事件传参只需要在触发事件的方法中，把需要传递的数据作为**形参**传入。
  + 小程序：不能直接在绑定事件的方法中传入参数，需要将参数作为属性值，绑定到元素上的 **data-属性**上，然后在方法中通过 `e.currentTarget.dataset.*`的方式获取，从而完成参数的传递。

+ **父子组件通信不一样：**

①子组件创建不一样：

```bash
在vue中需要：
1、编写子组件；
2、在需要使用的父组件中通过 import引入；
3、在 vue的 components中注册；
4、在模板中使用。
-----------------------------------------------
在小程序中需要： 
1、编写子组件  
2、在子组件的 json文件中，将该文件声明为组件；
3、在需要引入的父组件的 json文件中，在 usingComponents填写引入组件的组件名以及路径；
4、在父组件中，直接引入即可；
```

②父子组件传值不一样：

```bash
在vue中，
父组件向子组件传递数据，只需要在子组件通过 v-bind传入一个值，在子组件中，通过 props接收，即可完成数据的传递，子组件和父组件通信可以通过 this.emit将方法和数据传递给父组件。
---------------------------------------------
在小程序中，
父组件直接将值赋值给一个变量，在子组件 properties中，接收传递的值。
```

③如果父组件想要调用子组件的方法

```bash
vue会给子组件添加一个 ref属性，通过 this.refs.ref的值便可以获取到该子组件，然后便可以调用子组件中的任意方法。
小程序是给子组件添加 id或者 class，然后通过 this.selectComponent找到子组件，然后再调用子组件的方法。
```

## 小程序三种事件对象的属性列表

**基础事件（ BaseEvent )**

+ type ：事件类型
+ timeStamp ：事件生成时的时间戳
+ target ：触发事件的组件的属性值集合
+ currentTarget ：绑定事件的组件的一些属性集合



+  Event.target 和 event.currentTarget 的区别 

  + a) Event.target 是触发事件的对象 ，如： 事件委托， 冒泡 

  + b) currentTarget 是事件绑定的对象， 没有事件委托
  + 两者在没有冒泡的情况下，是一样的值 

  例子

  + 比如说现在有A和B， A.addChild(B) 
  + A监听鼠标点击事件，那么当点击B时，target是B，currentTarget是A 
  + currentTarget始终是监听事件者，而target是事件的真正发出者 

**自定义事件（ CustomEvent )**

+  detail 

**触摸事件（ TouchEvent )**

+ touches 

+ changedTouches 

## 小程序wxml与标准的html的区别

**相同**

+ 都得用来描述页面的结构
+ 都由标签、属性等结构

**不同**

+ 标签名字不一样，小程序标签更少，单一标签多

+ 多了一些wx:if这样属性以及{{}}这样的表达式
+ WXML仅能在小程序开发工具中预览，而HTML可以在浏览器内浏览
+ 组件封装不同，WXML对组件重新封装
+ 小程序运行在JS Core内，没有DOM树和window对象，小程序中无法使用document对象和window对象

## 小程序wxss与标准的css的区别

+ `wxss` 背景图片只能引入外链，不能使用本地图片
+ 小程序样式使用`@import` 引入外联样式文件，地址为相对路径
+ 尺寸单位为`rpx`，`rpx`是响应式像素，可以根据屏幕宽度进行自适应

## 小程序rpx单位

+ 是小程序独有的、**解决屏幕自适应的尺寸单位**
+ 可以根据屏幕宽度进行自适应，不论大小屏幕，**规定屏幕宽度为750rpx**
+ 通过rpx设置元素和字体大小，小程序在不同尺寸得屏幕小，**可以实现自动适配**

## rpx和px直接的换算

+ 以iPhone6为例，屏幕宽度为375px，共750个物理像素 ，则750rpx=375px=750物理像素
+ 1rpx=0.5px=1物理像素
+ `100px *30px`——>`200rpx*60rpx`

## bindtap和catchtap区别

相同点：都是点击事件

不同：catchtap可以阻止冒泡，bindtap不会阻止冒泡



## 小程序的开发，发送一个请求，怎么请求数据的

**1、在微信小程序进行网络通信，只能和指定的域名进行通信**
服务器域名在：`小程序后台＝＞开发＝＞开发设置=＞服务器域名`中配置，配置时需注意：

+ 域名只支持 https ( request , uploadFile , downloadFile ）和 wss ( connectSocket ）协议。
+ 域名不能使用 ip 地址或 localhost 。
+ 域名必须经 ICP 备案。
+ 服务器域名一个月内可申请5次修改。

**2、微信小程序包括四种类型的网络请求**

+ 普通 HTTPS 请求（ wx . request )
+ 上传文件（ wx. uploadFile )
+ 下载文件（ wx. downloadFile )
+  WebSocket 通信（ wx. connectSocket )

**3、小程序没有跨域的限制：**

+ 在普通网站中，由于浏览器的同源策略限制，存在数据的跨域请求问题，从而衍生出 JSONP 和 CORS 两种主流的跨域问解决方案
+ 但是小程序内部运机制与网页不同，小程序中的戴拿不运行在浏览器中，因此小程序开发中，不存在数据的跨域请求限制问题

## 页面间递数据的方法

+ 使用全局变量实现数据传递
+ 页面跳转或重定向时，使用 url 带参数传递数据
+ 使用组件模板 template 传递参数
+ 使用缓存传递参数
+ 使用数据库传递数据

## 微信小程序的优劣势

**优势：**

+ 无需下载，通过搜索和扫一扫就可以打开。●良好的用户体验：打开速度快。
+ 开发成本要比 App 要低。
+ 安卓上可以添加到桌面，与原生 App 差不多。
+ 为用户提供良好的安全保障。小程序的发布，微信拥有一套严格的审查流程，不能通过审查的小程序是无法发布到线上的。

**劣势：**

+ 限制较多。页面大小不能超过1M。不能打开超过5个层级的页面。
+ 样式单一。小程序的部分组件已经是成型的了，样式不可以修改。例如：幻灯片、导航。
+ 推广面窄，不能分享朋友圈，只能通过分享给朋友，附近小程序推广。其中附近小程序也受到微信的限制。
+ 依托于微信，无法开发后台管理功能。